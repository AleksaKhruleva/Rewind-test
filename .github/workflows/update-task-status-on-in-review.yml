name: Update Task Status on inReview

on:
  pull_request:
    types:
      - opened
      - reopened

jobs:
  update-status:
    runs-on: ubuntu-latest

    steps:
      - name: Checkout Repository  # –û–±—è–∑–∞—Ç–µ–ª—å–Ω–æ –∑–∞–≥—Ä—É–∂–∞–µ–º —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π, —á—Ç–æ–±—ã —ç–∫—à–Ω—ã —Å—Ç–∞–ª–∏ –¥–æ—Å—Ç—É–ø–Ω—ã
        uses: actions/checkout@v4

      - name: Check PR Title Format
        id: check_pr_title
        uses: ./.github/actions/check-pr-title  # –ò—Å–ø–æ–ª—å–∑—É–µ–º —ç–∫—à–Ω –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ –Ω–∞–∑–≤–∞–Ω–∏—è PR
        with:
          pr_title: ${{ github.event.pull_request.title }}

      - name: Debug Issue Key
        run: |
          echo "üîë Extracted ISSUE_KEY: ${{ steps.check_pr_title.outputs.issue_key }}"  # –ü—Ä–æ–≤–µ—Ä—è–µ–º, —á—Ç–æ ISSUE_KEY –ø–µ—Ä–µ–¥–∞—ë—Ç—Å—è

      - name: Update Task Status to "inReview"
        uses: ./.github/actions/update-task-status  # –ò—Å–ø–æ–ª—å–∑—É–µ–º —ç–∫—à–Ω –¥–ª—è –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è —Å—Ç–∞—Ç—É—Å–∞
        with:
          issue_key: ${{ steps.check_pr_title.outputs.issue_key }}  # –ü–µ—Ä–µ–¥–∞—ë–º –∫–ª—é—á –∑–∞–¥–∞—á–∏ –∏–∑ –ø—Ä–µ–¥—ã–¥—É—â–µ–≥–æ —ç–∫—à–Ω–∞
          transition_id: "inReview1"
          yandex_token: ${{ secrets.YANDEX_TRACKER_TOKEN }}
          yandex_org_id: ${{ secrets.YANDEX_CLOUD_ORG_ID }}
